function setValue(obj,access,value){if("string"==typeof access&&(access=access.split(".")),access.length>1){var init=obj[access[0]]||{};setValue(obj[access.shift()]=init,access,value)}else obj[access[0]]=value}addOptinomicExtras=function(obj,api_url){return api_url=api_url||null,obj.api_timestamp=(new Date).toISOString(),obj.api_url=api_url,obj},handleError=function(req,error_action){var error={error:!0,error_message:"Failed with status code: "+req.status,status:req.status,statusText:req.statusText,responseURL:req.responseURL,readyState:req.readyState,error_action:error_action};try{var responseText=JSON.parse(req.responseText);"error"in responseText&&(error.responseErrorText=responseText.error)}catch(err){error.responseErrorText=null}return 0!==req.status&&console.error("(!) "+req.status+" ("+req.statusText+")",error),error},debounce=function(fn,wait){var timeout=null,c=function(){clearTimeout(timeout),timeout=null},t=function(fn){timeout=setTimeout(fn,wait)};return function(){var context=this,args=arguments,f=function(){fn.apply(context,args)};timeout?c()||t(f):t(c)||f()}},formatDateCH=function(date_string){if(null!==(date_string=date_string||null)){var year=parseInt(date_string.substring(0,4)),month=parseInt(date_string.substring(5,7));return parseInt(date_string.substring(8,10))+"."+month+"."+year}return null},createPatientExtras=function(patient){var dateString,today,birthDate,age,m;patient.extras={},patient.extras.age=(dateString=patient.birthdate,today=new Date,birthDate=new Date(dateString),age=today.getFullYear()-birthDate.getFullYear(),((m=today.getMonth()-birthDate.getMonth())<0||0===m&&today.getDate()<birthDate.getDate())&&age--,age),patient.extras.birthday=formatDateCH(patient.birthdate),patient.extras.birthday_age=patient.extras.birthday+" | "+patient.extras.age,patient.extras.name=patient.last_name+" "+patient.first_name;var birthYear=new Date(patient.birthdate);birthYear=birthYear.getFullYear(),patient.extras.birth_year=birthYear,patient.extras.secure=patient.last_name.substring(0,2)+". "+patient.first_name.substring(0,1)+". ("+birthYear+")","male"===patient.gender?(patient.extras.ansprache="Herr",patient.extras.anrede="Herr "+patient.last_name):(patient.extras.ansprache="Frau",patient.extras.anrede="Frau "+patient.last_name),patient.extras.full_name=patient.extras.ansprache+" "+patient.extras.name+" ("+patient.extras.birthday_age+")",patient.extras.full_address=patient.address1+", "+patient.zip_code+" "+patient.city;var myPhone="";patient.phone_home&&(myPhone=patient.phone_home),patient.phone_mobile&&(myPhone=""!=myPhone?myPhone+", "+patient.phone_mobile:patient.phone_mobile),patient.extras.phone=myPhone,patient.extras.infoline=patient.extras.full_address,""!=myPhone&&(patient.extras.infoline,patient.extras.phone);var myColor="#3F51B5",myColorAccent="#E91E63";return"female"===patient.gender&&(myColor="#E91E63",myColorAccent="#3F51B5"),patient.extras.color_main=myColor,patient.extras.color_accent=myColorAccent,patient.extras},createStayExtras=function(current_stay){current_stay.extras={},current_stay.extras.in_stay=!1,current_stay.stop?(current_stay.extras.duration=Math.floor((Date.parse(current_stay.stop)-Date.parse(current_stay.start))/864e5),current_stay.extras.duration=current_stay.extras.duration+1):current_stay.extras.duration=Math.floor((new Date-Date.parse(current_stay.start))/864e5);var phase=current_stay.phase,translated_de="";return"before_stay"===phase&&(translated_de="Bevorstehende Behandlung",translated_en="the stay starts in the future"),"in_stay"===phase&&(translated_de="In aktueller Behandlung",translated_en="the patient is currently in stay",current_stay.extras.in_stay=!0),"after_exit"===phase&&(translated_de="Die Behandlung wurde vor weniger als 14 Tage beendet",translated_en="the stay ended less than 14 days ago (included)"),"frozen"===phase&&(translated_de="Die Behandlung wurde manuell eingefroren",translated_en="the stay has manually been frozen (no more events, changes, ...)"),"unfrozen"===phase&&(translated_de="Die Behandlung ist abgeschlossen, wurde jedoch zur Bearbeitung wieder geÃ¶ffnet",translated_en="the stay is complete but has been unfrozen by somebody"),"complete"===phase&&(translated_de="Die Behandlung wurde vor mehr als 14 Tage beendet",translated_en="the stay ended more than 14 days ago"),current_stay.extras.phase_de=translated_de,current_stay.extras.phase_en=translated_en,current_stay.extras.beginn=formatDateCH(current_stay.start),current_stay.extras.from_to=formatDateCH(current_stay.start),current_stay.extras.from_to=current_stay.extras.from_to+" - ",current_stay.stop?(current_stay.extras.from_to=current_stay.extras.from_to+formatDateCH(current_stay.stop),current_stay.extras.ende=formatDateCH(current_stay.stop)):current_stay.extras.from_to=current_stay.extras.from_to+"Unbekannt",current_stay.extras},createEventExtras=function(current_event){var extras={};return extras.created_at=formatDateCH(current_event.created_at),extras.due=formatDateCH(current_event.due),extras.status=current_event.status.charAt(0).toUpperCase()+current_event.status.slice(1),extras.status_de="Undefined","done"===current_event.status&&(extras.status_de="Erledigt",extras.show_do_it_now=!1),"to_be_done"===current_event.status&&(extras.status_de="Offen",extras.show_do_it_now=!0),"aborted"===current_event.status&&(extras.status_de="Abgebrochen",extras.show_do_it_now=!1),"irrelevant"===current_event.status&&(extras.status_de="Nicht relevant",extras.show_do_it_now=!1),extras};